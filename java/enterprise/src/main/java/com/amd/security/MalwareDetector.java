package com.amd.security;

import java.util.*;

public class MalwareDetector {
    
    private List<String> suspiciousPatterns;
    
    public MalwareDetector() {
        initializePatterns();
    }
    
    private void initializePatterns() {
        suspiciousPatterns = Arrays.asList(
            "eval", "exec", "system", "Runtime.getRuntime",
            "ProcessBuilder", "cmd.exe", "/bin/sh", "bash -i"
        );
    }
    
    public float detect(String code) {
        if (code == null || code.isEmpty()) {
            return 0.0f;
        }
        
        float threatLevel = 0.0f;
        int suspiciousCount = 0;
        String lowerCode = code.toLowerCase();
        
        for (String pattern : suspiciousPatterns) {
            if (lowerCode.contains(pattern.toLowerCase())) {
                suspiciousCount++;
                threatLevel += 0.15f;
            }
        }
        
        return Math.min(threatLevel, 1.0f);
    }
}